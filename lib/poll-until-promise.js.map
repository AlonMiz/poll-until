{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1293b4f305769759a281","webpack:///./index.js","webpack:///./src/poll-until-promise.js"],"names":["module","exports","require","PollUntil","options","_PromiseModule","Promise","_setTimeoutModule","setTimeout","_interval","interval","_timeout","timeout","_stopOnFailure","stopOnFailure","_isWaiting","_isResolved","ERRORS","NOT_FUNCTION","FAILED_TO_WAIT","executeFn","_executeFn","_applyPromiseHandlers","_validateExecution","start","Date","now","_runFunction","promise","stop","resolve","reject","Error","_timeFromStart","bind","setInterval","_shouldStopTrying","_failedToWait","executor","then","result","_executeAgain","catch","err"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;AC7DAA,OAAOC,OAAP,GAAiB,mBAAAC,CAAQ,CAAR,CAAjB,C;;;;;;;;;;;;;;;ICAMC,S;AACJ,uBAA0B;AAAA,QAAdC,OAAc,uEAAJ,EAAI;;AAAA;;AACxB;AACA,SAAKC,cAAL,GAAsBD,QAAQE,OAAR,IAAmBA,OAAzC;AACA,SAAKC,iBAAL,GAAyBH,QAAQI,UAAjC;;AAEA,SAAKC,SAAL,GAAiBL,QAAQM,QAAR,IAAoB,IAArC;AACA,SAAKC,QAAL,GAAgBP,QAAQQ,OAAR,IAAmB,KAAK,IAAxC;AACA,SAAKC,cAAL,GAAsBT,QAAQU,aAAR,IAAyB,KAA/C;AACA,SAAKC,UAAL,GAAkB,KAAlB;AACA,SAAKC,WAAL,GAAmB,KAAnB;;AAEA,SAAKC,MAAL,GAAc;AACZC,oBAAc,oEADF;AAEZC,sBAAgB;AAFJ,KAAd;AAID;;;;6BAEQT,Q,EAAU;AACjB,WAAKD,SAAL,GAAiBC,QAAjB;AACA,aAAO,IAAP;AACD;;;8BACSE,O,EAAS;AACjB,WAAKD,QAAL,GAAgBC,OAAhB;AACA,aAAO,IAAP;AACD;;;4BACOQ,S,EAAW;AACjB,WAAKC,UAAL,GAAkBD,SAAlB;;AAEA,WAAKE,qBAAL;AACA,WAAKC,kBAAL;;AAEA,WAAKC,KAAL,GAAaC,KAAKC,GAAL,EAAb;AACA,WAAKX,UAAL,GAAkB,IAAlB;;AAEA,WAAKY,YAAL;;AAEA,aAAO,KAAKC,OAAZ;AACD;;;iCACY;AACX,aAAO,KAAKA,OAAZ;AACD;;;iCACY;AACX,aAAO,KAAKZ,WAAZ;AACD;;;gCACW;AACV,aAAO,KAAKD,UAAZ;AACD;;;kCACac,I,EAAM;AAClB,WAAKhB,cAAL,GAAsBgB,IAAtB;AACA,aAAO,IAAP;AACD;;;4CAGuB;AAAA;;AACtB,WAAKD,OAAL,GAAe,IAAI,KAAKvB,cAAT,CAAwB,UAACyB,OAAD,EAAUC,MAAV,EAAqB;AAC1D,cAAKD,OAAL,GAAeA,OAAf;AACA,cAAKC,MAAL,GAAcA,MAAd;AACD,OAHc,CAAf;AAID;;;yCACoB;AACnB,UAAI,OAAO,KAAKV,UAAZ,KAA2B,UAA/B,EAA2C;AACzC,cAAM,IAAIW,KAAJ,CAAU,KAAKf,MAAL,CAAYC,YAAtB,CAAN;AACD;AACF;;;qCACgB;AACf,aAAOO,KAAKC,GAAL,KAAa,KAAKF,KAAzB;AACD;;;wCACmB;AAClB,aAAO,KAAKS,cAAL,KAAwB,KAAKtB,QAApC;AACD;;;oCACe;AACd,UAAI,KAAKJ,iBAAT,EAA4B;AAC1B,aAAKA,iBAAL,CAAuB,KAAKoB,YAAL,CAAkBO,IAAlB,CAAuB,IAAvB,CAAvB,EAAqD,KAAKzB,SAA1D;AACD,OAFD,MAEO;AACL0B,oBAAY,KAAKR,YAAL,CAAkBO,IAAlB,CAAuB,IAAvB,CAAZ,EAA0C,KAAKzB,SAA/C;AACD;AACF;;;oCACe;AACd,aAAU,KAAKQ,MAAL,CAAYE,cAAtB,eAA8C,KAAKc,cAAL,EAA9C;AACD;;;mCACc;AAAA;;AACb,UAAI,KAAKG,iBAAL,EAAJ,EAA8B;AAC5B,aAAKrB,UAAL,GAAkB,KAAlB;AACA,aAAKgB,MAAL,CAAY,KAAKM,aAAL,EAAZ;AACA;AACD;;AAED,UAAIC,WAAW,KAAKjB,UAAL,EAAf;AACA,UAAI,QAAOiB,QAAP,yCAAOA,QAAP,OAAoB,QAApB,IAAgC,OAAOA,SAASC,IAAhB,KAAyB,UAA7D,EAAyE;AACvED,mBAAW,IAAI,KAAKjC,cAAT,CAAwB;AAAA,iBAAWyB,QAAQQ,QAAR,CAAX;AAAA,SAAxB,CAAX;AACD;AACDA,eACGC,IADH,CACQ,UAACC,MAAD,EAAY;AAChB,YAAIA,MAAJ,EAAY;AACV,iBAAKV,OAAL,CAAaU,MAAb;AACA,iBAAKzB,UAAL,GAAkB,KAAlB;AACA,iBAAKC,WAAL,GAAmB,IAAnB;AACA;AACD;AACD,eAAKyB,aAAL;AACD,OATH,EAUGC,KAVH,CAUS,UAACC,GAAD,EAAS;AACd,YAAI,OAAK9B,cAAT,EAAyB;AACvB,iBAAO,OAAKkB,MAAL,CAAYY,GAAZ,CAAP;AACD;AACD,eAAO,OAAKF,aAAL,EAAP;AACD,OAfH;AAgBD;;;;;;AAGHzC,OAAOC,OAAP,GAAiBE,SAAjB,C","file":"poll-until-promise.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"PollUntil\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PollUntil\"] = factory();\n\telse\n\t\troot[\"PollUntil\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1293b4f305769759a281","module.exports = require('./src/poll-until-promise');\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","class PollUntil {\n  constructor(options = {}) {\n    // Used for angularJs internal functions, eg. $interval, $q, $timeout\n    this._PromiseModule = options.Promise || Promise;\n    this._setTimeoutModule = options.setTimeout;\n\n    this._interval = options.interval || 1000;\n    this._timeout = options.timeout || 20 * 1000;\n    this._stopOnFailure = options.stopOnFailure || false;\n    this._isWaiting = false;\n    this._isResolved = false;\n\n    this.ERRORS = {\n      NOT_FUNCTION: 'Your executor is not a function. functions and promises are valid.',\n      FAILED_TO_WAIT: 'Failed to wait'\n    };\n  }\n\n  tryEvery(interval) {\n    this._interval = interval;\n    return this;\n  }\n  stopAfter(timeout) {\n    this._timeout = timeout;\n    return this;\n  }\n  execute(executeFn) {\n    this._executeFn = executeFn;\n\n    this._applyPromiseHandlers();\n    this._validateExecution();\n\n    this.start = Date.now();\n    this._isWaiting = true;\n\n    this._runFunction();\n\n    return this.promise;\n  }\n  getPromise() {\n    return this.promise;\n  }\n  isResolved() {\n    return this._isResolved;\n  }\n  isWaiting() {\n    return this._isWaiting;\n  }\n  stopOnFailure(stop) {\n    this._stopOnFailure = stop;\n    return this;\n  }\n\n\n  _applyPromiseHandlers() {\n    this.promise = new this._PromiseModule((resolve, reject) => {\n      this.resolve = resolve;\n      this.reject = reject;\n    });\n  }\n  _validateExecution() {\n    if (typeof this._executeFn !== 'function') {\n      throw new Error(this.ERRORS.NOT_FUNCTION);\n    }\n  }\n  _timeFromStart() {\n    return Date.now() - this.start;\n  }\n  _shouldStopTrying() {\n    return this._timeFromStart() > this._timeout;\n  }\n  _executeAgain() {\n    if (this._setTimeoutModule) {\n      this._setTimeoutModule(this._runFunction.bind(this), this._interval);\n    } else {\n      setInterval(this._runFunction.bind(this), this._interval);\n    }\n  }\n  _failedToWait() {\n    return `${this.ERRORS.FAILED_TO_WAIT} after ${this._timeFromStart()}ms`;\n  }\n  _runFunction() {\n    if (this._shouldStopTrying()) {\n      this._isWaiting = false;\n      this.reject(this._failedToWait());\n      return;\n    }\n\n    let executor = this._executeFn();\n    if (typeof executor !== 'object' || typeof executor.then !== 'function') {\n      executor = new this._PromiseModule(resolve => resolve(executor));\n    }\n    executor\n      .then((result) => {\n        if (result) {\n          this.resolve(result);\n          this._isWaiting = false;\n          this._isResolved = true;\n          return;\n        }\n        this._executeAgain();\n      })\n      .catch((err) => {\n        if (this._stopOnFailure) {\n          return this.reject(err);\n        }\n        return this._executeAgain();\n      });\n  }\n}\n\nmodule.exports = PollUntil;\n\n\n\n// WEBPACK FOOTER //\n// ./src/poll-until-promise.js"],"sourceRoot":""}